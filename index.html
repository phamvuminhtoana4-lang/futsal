<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Ultimate Futsal Strategy Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;background:#020617;color:#fff;font-family:Arial;text-align:center}
h2{margin:10px}
canvas{background:#16a34a;border:3px solid #fff;border-radius:12px}
button{padding:8px 12px;margin:3px;border:none;border-radius:8px;font-weight:bold}
#panel{margin:5px}
#hud{font-size:16px}
</style>
</head>
<body>

<h2>‚öΩ Ultimate Futsal Strategy Game</h2>
<canvas id="game" width="360" height="600"></canvas>

<div id="panel">
  <button onclick="setTactic('attack')">üî• T·∫•n c√¥ng</button>
  <button onclick="setTactic('balance')">‚öñÔ∏è C√¢n b·∫±ng</button>
  <button onclick="setTactic('defend')">üõ°Ô∏è Ph√≤ng th·ªß</button>
</div>

<div id="hud">
  ‚è±Ô∏è <span id="time">0</span>s |
  üî¥ <span id="myScore">0</span> -
  <span id="aiScore">0</span> ‚ö™
</div>
<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let tactic="balance";
let myScore=0, aiScore=0;
let matchTime=0, half=1;

const ball={x:180,y:300,vx:0,vy:0,r:6};
const team=[], enemy=[];
    for(let i=0;i<5;i++){
 team.push({x:70,y:120+i*80,r:8,speed:0.7,level:1});
 enemy.push({x:290,y:120+i*80,r:8,speed:0.6});
}

function drawField(){
 ctx.fillStyle="#16a34a";
 ctx.fillRect(0,0,360,600);
 ctx.strokeStyle="#fff";
 ctx.strokeRect(10,10,340,580);
 ctx.strokeRect(0,240,10,120);
 ctx.strokeRect(350,240,10,120);
}
    let dragging=null;

canvas.addEventListener("touchstart",e=>{
 const t=e.touches[0];
 const x=t.clientX-canvas.offsetLeft;
 const y=t.clientY-canvas.offsetTop;
 team.forEach(p=>{
  if(Math.hypot(p.x-x,p.y-y)<p.r+10) dragging=p;
 });
 ball.vx=(x-ball.x)*0.04;
 ball.vy=(y-ball.y)*0.04;
});

canvas.addEventListener("touchmove",e=>{
 if(!dragging) return;
 const t=e.touches[0];
 dragging.x=t.clientX-canvas.offsetLeft;
 dragging.y=t.clientY-canvas.offsetTop;
});

canvas.addEventListener("touchend",()=>dragging=null);
    function setTactic(t){tactic=t}

function teamAI(p){
 if(tactic==="attack") p.x+=0.4;
 if(tactic==="defend") p.x-=0.4;
}

function enemyAI(p){
 if(ball.x<p.x) p.x-=p.speed;
 if(ball.x>p.x) p.x+=p.speed;
 if(ball.y<p.y) p.y-=p.speed;
 if(ball.y>p.y) p.y+=p.speed;
}
    function checkGoal(){
 if(ball.x<0&&ball.y>240&&ball.y<360){aiScore++;resetBall()}
 if(ball.x>360&&ball.y>240&&ball.y<360){myScore++;resetBall()}
 document.getElementById("myScore").innerText=myScore;
 document.getElementById("aiScore").innerText=aiScore;
}

function resetBall(){ball.x=180;ball.y=300;ball.vx=ball.vy=0}

setInterval(()=>{
 matchTime++;
 document.getElementById("time").innerText=matchTime;
},1000);
    function saveGame(){
 localStorage.setItem("futsalSave",JSON.stringify({myScore,aiScore}));
}
function loadGame(){
 const d=JSON.parse(localStorage.getItem("futsalSave"));
 if(d){myScore=d.myScore;aiScore=d.aiScore}
}
loadGame();
    function drawPlayers(){
 team.forEach(p=>{ctx.fillStyle="red";ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,7);ctx.fill();teamAI(p)});
 enemy.forEach(p=>{ctx.fillStyle="white";ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,7);ctx.fill();enemyAI(p)});
}

function drawBall(){
 ctx.fillStyle="yellow";
 ctx.beginPath();
 ctx.arc(ball.x,ball.y,ball.r,0,7);
 ctx.fill();
 ball.x+=ball.vx; ball.y+=ball.vy;
 ball.vx*=0.98; ball.vy*=0.98;
}

function loop(){
 drawField();
 drawPlayers();
 drawBall();
 checkGoal();
 requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
